#!/usr/bin/python3

import pymongo
import json
import pymysql


def get_mongo_connect():
    client = pymongo.MongoClient()
    db = client["wakaTime"]
    # name = client.database_names()
    # print(name)
    return db


def openfile():
    # 打开文本文件
    url = '/home/bokket/dbscan.txt'

    file = open(url, 'r')
    js = file.read()
    dic = json.loads(js)
    print(dic)
    file.close()
    return dic


def insert_dbscan():
    # dic = openfile()

    db = get_mongo_connect()
    # table
    cluster = db['dbscan']

    rep = cluster.insert_many([{"Point": "1",
                                "HorizontalCoordinates": [0, 1991, 0, 0, 0, 0, 0, 1326, 0, 1232, 0, 0, 0, 0, 0, 0, 0, 0,
                                                          0, 0, 0, 0, 0, 0, 0, 0, 2776, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                                          0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                                          0,
                                                          0, 0, 22, 2504],
                                "VerticalCoordinates": [3520, 269, 594, 2336, 5283, 4630, 374, 0, 3800, 106, 1219, 2003,
                                                        6210, 215, 6454, 2854, 4117, 6936, 41, 4367, 5026, 1484, 6048,
                                                        8574, 1615, 172, 0, 3778, 3055, 2036, 474, 7, 65, 190, 2533,
                                                        919,
                                                        2173, 2963, 147, 0, 1236, 4955, 8314, 1593, 8988, 5266, 296,
                                                        3124,
                                                        4143, 9061, 2587, 2953, 2706, 973, 3197, 7865, 1327, 12, 1040,
                                                        851, 5781, 7019, 55]},
                               {"Point": "2",
                                "HorizontalCoordinates": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                "VerticalCoordinate": [12491, 14384, 12349, 12079, 10607, 10500, 10847, 11039, 13482,
                                                       11688, 12775]}
                               ])

    print(rep.inserted_ids)

    # cluster={
    #    1: [(0, 3520), (1991, 269), (0, 594), (0, 2336), (0, 5283), (0, 4630), (0, 374), (1326, 0), (0, 3800), (1232, 106), (0, 1219), (0, 2003), (0, 6210), (0, 215), (0, 6454), (0, 2854), (0, 4117), (0, 6936), (0, 41), (0, 4367), (0, 5026), (0, 1484), (0, 6048), (0, 8574), (0, 1615), (0, 172), (2776, 0), (0, 3778), (0, 3055), (0, 2036), (0, 474), (0, 7), (0, 65), (0, 190), (0, 2533), (0, 919), (0, 2173), (0, 2963), (0, 147), (20, 0), (0, 1236), (0, 4955), (0, 8314), (0, 1593), (0, 8988), (0, 5266), (0, 296), (0, 3124), (0, 4143), (0, 9061), (0, 2587), (0, 2953), (0, 2706), (0, 973), (0, 3197), (0, 7865), (0, 1327), (0, 12), (0, 1040), (0, 851), (0, 5781), (22, 7019), (2504, 55)],
    #    2: [(0, 12491), (0, 14384), (0, 12349), (0, 12079), (0, 10607), (0, 10500), (0, 10847), (0, 11039), (0, 13482), (0, 11688), (0, 12775)]
    # }


# def insert_dbscan():


# def init_wakatime():


# if __name__ == "__main__":
#     insert_dbscan()
#     # init_wakatime()
#     pass
